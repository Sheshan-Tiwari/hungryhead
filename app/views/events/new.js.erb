if($('#new_event_popup').length > 0) {
  $('#new_event_popup').remove();
}
//Find body and append a div
var $el = $('body');
$el.append($('<div>', {class: 'new_event_popup', id: 'new_event_popup'}));
var $container = $('#new_event_popup');

//Append popup to html
$container.html("<%= j render partial: 'popup' %>");

// Fund popup and append with form
var $popup = $('#eventPopupModal')
$popup.find('#event_popup_body').html("<%= j render partial: 'form' %>");
$popup.modal('show');

//Add client side validation
$('form#new_event').validate();
try {
  //title validate
  $('#event_title').rules('add', {
    minlength: 10,
    maxlength: 50
  });

  //Add client side rules
  $('#event_excerpt').rules('add', {
    minlength: 100,
    maxlength: 300
  });
} catch(e) {}

//Init date picker plugin
$('#startdatepicker').datetimepicker({sideBySide: true});
$('#enddatepicker').datetimepicker({sideBySide: true});

//Init autosize
$('body').on('focus', 'textarea', function(event) {
  event.preventDefault();
  $(this).autosize();
});